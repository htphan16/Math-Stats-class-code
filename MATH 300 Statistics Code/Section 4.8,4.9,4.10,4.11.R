# 4.8-7
qf(0.95, 2, 9)
a = c(38.7,39.2,40.1,38.9)
b = c(41.9,42.3,41.3)
c = c(40.8,41.2,39.5,38.9,40.3)

ovrmean = (sum(a)+sum(b)+sum(c))/12
sst = 4*((mean(a)-ovrmean)**2)+3*((mean(b)-ovrmean)**2)+5*((mean(c)-ovrmean)**2)
sst
sse = sum((a-mean(a))**2)+sum((b-mean(b))**2)+sum((c-mean(c))**2)
sse
f = (sst/2)/(sse/9)
f

# 4.8-8 (a)
y1 = c(92,90,87,105,86,83,102)
y2 = c(100,108,98,110,114,97,94)
y3 = c(143,149,138,136,139,120,145)
y4 = c(147,144,160,149,152,131,134)
y5 = c(142,155,119,134,133,146,152)
# t-test
qt(0.975,6)
mean(y1-y2)
sd(y1-y2)
t = mean(y1-y2)/(sd(y1-y2)/sqrt(6))
abs(t)
# F-test
qf(0.95, 1, 12)
ovrmean = (sum(y1)+sum(y2))/14
sst = 7*((mean(y1)-ovrmean)**2+(mean(y2)-ovrmean)**2)
sst
sse = sum((y1-mean(y1))**2)+sum((y2-mean(y2))**2)
sse
f = (sst/1)/(sse/12)
f
# 4.8-8 (b)
qf(0.95, 2, 18)
ovrmean = (sum(y3)+sum(y4)+sum(y5))/21
sst = 7*((mean(y3)-ovrmean)**2+(mean(y4)-ovrmean)**2+(mean(y5)-ovrmean)**2)
sst
sse = sum((y3-mean(y3))**2)+sum((y4-mean(y4))**2)+sum((y5-mean(y5))**2)
sse
f = (sst/2)/(sse/18)
f

# 4.9-1 (a)
qnorm(0.975, mean = 0, sd = 1)
5-1.5*qnorm(0.975, mean = 0, sd = 1)

# 4.9-6 (d)
x = c(79,315,445,350,136,723,198,75,161,113,215,24,57,152,
      238,288,272,9,315,11,51,98,620,244,34)
mean(x)
sd(x)
208.92-2*182.9157/5
208.92+2*182.9157/5
13-5*0.5*qnorm(0.975, mean = 0, sd = 1)

# 4.10-1
224/4
qchisq(0.95,3) 
q = ((42-56)**2+(64-56)**2+(53-56)**2+(65-56)**2)/56
q

# 4.10-4
q = (((124-198*9/16)**2)/(198*9/16)+((30-198*3/16)**2)/(198*3/16)
+((43-198*3/16)**2)/(198*3/16)+((11-198*1/16)**2)/(198*1/16))
q

# 4.10-7
qchisq(0.95,5)
p0 = dpois(0, 2.4, log = FALSE)
p1 = dpois(1, 2.4, log = FALSE)
p2 = dpois(2, 2.4, log = FALSE)
p3 = dpois(3, 2.4, log = FALSE)
p4 = dpois(4, 2.4, log = FALSE)
p5 = 1-ppois(4, 2.4, lower.tail = TRUE)
q = (((5-40*p0)**2)/(40*p0)+((7-40*p1)**2)/(40*p1)+((12-40*p2)**2)/(40*p2)
+((9-40*p3)**2)/(40*p3)+((5-40*p4)**2)/(40*p4)+((2-40*p5)**2)/(40*p5))
q

# 4.11-2
qchisq(0.95,2) 
q = ((7-5)**2+(4-5)**2+(4-5)**2+(3-5)**2+(6-5)**2+(6-5)**2)/5
q

# 4.11-3
qchisq(0.95,2*2) 
q = ((9-5)**2+(4-5)**2+(2-5)**2+(5-5)**2+(5-5)**2+(5-5)**2+(1-5)**2+(6-5)**2+(8-5)**2)/5
q

# 4.11-7
qchisq(0.95,3*4)
q = (((8-(23*31/200))**2)/(23*31/200)+((5-(23*42/200))**2)/(23*42/200)+((6-(23*47/200))**2)/(23*47/200)
+((3-(23*53/200))**2)/(23*53/200)+((1-(23*27/200))**2)/(23*27/200)+((9-(35*31/200))**2)/(35*31/200)
+((11-(35*42/200))**2)/(35*42/200)+((7-(35*47/200))**2)/(35*47/200)+((5-(35*53/200))**2)/(35*53/200)
+((3-(35*27/200))**2)/(35*27/200)+((10-(78*31/200))**2)/(78*31/200)+((15-(78*42/200))**2)/(78*42/200)
+((20-(78*47/200))**2)/(78*47/200)+((22-(78*53/200))**2)/(78*53/200)+((11-(78*27/200))**2)/(78*27/200)
+((4-(64*31/200))**2)/(64*31/200)+((11-(64*42/200))**2)/(64*42/200)+((14-(64*47/200))**2)/(64*47/200)
+((23-(64*53/200))**2)/(64*53/200)+((12-(64*27/200))**2)/(64*27/200))
q


