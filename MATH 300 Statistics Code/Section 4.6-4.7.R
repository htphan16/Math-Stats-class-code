# 4.6-1 (a)
x = c(70,74,80,84,80,67,70,64,74,82)
y = c(87,79,88,98,96,73,83,79,91,94)
a = mean(y)
a
(sum(x*y) - mean(y)*sum(x))
(sum(x*x) - sum(x)*sum(x)/10)
b = (sum(x*y) - mean(y)*sum(x))/(sum(x*x) - sum(x)*sum(x)/10)
b
mean(x)
# 4.6-1 (b)
plot(x, y, xlab="Midterm", ylab="Final", pch = 16)
lm(y ~ x)
abline(lm(y ~ x))
# 4.6-1 (c)
0.1*sum((y-a-b*(x-mean(x)))**2)

# 4.6-3 (a)
x = c(0,0,0,50,50,50,75,75,75,100,100,100,150,150,150,200,200,200)
y = c(1.72,1.68,1.74,2.04,2.11,2.17,2.40,2.32,2.33,2.91,3.00,2.89,4.47,4.51,4.43,6.67,6.66,6.57)
r = cov(x,y)/(sd(x)*sd(y))
r
a = mean(y)
a
b = cov(x,y)/var(x)
b
mean(x)
# 4.6-3 (b)
plot(x, y, xlab="ppm", ylab="mV", cex=0.7, pch = 16)
lm(y ~ x)
abline(lm(y ~ x))
# 4.6-3 (c)
yi = a + b*(x-mean(x))
y-yi
plot(x,y-yi,ylab="residual",cex=0.7, pch = 16)

# 4.6-7 (a)
x = c(32,23,23,23,26,30,17,20,17,18,26,16,21,24,30)
y = c(28,25,24,32,31,27,23,30,18,18,32,22,28,31,26)
a = mean(y)
a
b = cov(x,y)/var(x)
b
mean(x)
# 4.6-7 (b)
plot(x, y, pch = 16)
lm(y ~ x)
abline(lm(y ~ x))
# 4.6-7 (c)
a
b
var = sum((y-a-b*(x-mean(x)))**2)/15
var
a - qt(0.975, 13, lower.tail = TRUE, log.p = FALSE)*sqrt(var/13)
a + qt(0.975, 13, lower.tail = TRUE, log.p = FALSE)*sqrt(var/13)
b - qt(0.975, 13, lower.tail = TRUE, log.p = FALSE)*sqrt((15*var)/(13*sum((x-mean(x))**2)))
b + qt(0.975, 13, lower.tail = TRUE, log.p = FALSE)*sqrt((15*var)/(13*sum((x-mean(x))**2)))
15*var/qchisq(0.975, 13, ncp = 0, lower.tail = TRUE, log.p = FALSE)
15*var/qchisq(0.025, 13, ncp = 0, lower.tail = TRUE, log.p = FALSE)

# 4.6-8
qt(0.9875, 8, lower.tail = TRUE, log.p = FALSE)
x = c(70,74,80,84,80,67,70,64,74,82)
1.015682/sqrt(10*17.99981/(8*sum((x-mean(x))**2)))

# 4.6-12 (a)
x = c(38,56,24,40,15,53,102,58,49,68,90,31,102,28,79,28,
      56,77,46,39,14,51,39,58,93,63,74,46,78)
y = c(62,102,36,69,18,67,171,97,84,103,155,50,137,45,130,
      46,88,113,60,63,23,76,73,92,136,102,93,76,118)
plot(y,x+y, xlab="b", ylab="a+b", cex= 0.7, pch=16)
# 4.6-12 (b)
a = mean(x+y)
a
b = cov(y,x+y)/var(y)
b
mean(y)
lm((x+y) ~ y)
abline(lm((x+y) ~ y), col="red")
# 4.6-12 (c)
g = (1+sqrt(5))/2
abline(0, g, col="blue")
legend(12, 282, legend=c("Least square regression line", "y = gx"),
       col=c("red", "blue"), lty=1:1, cex=0.8)
# 4.6-12 (d)
mean((x+y)/y)
g

# 4.7-1 (a)
# x = 68
86.8+1.015682*(68-74.5)
x = c(70,74,80,84,80,67,70,64,74,82)
qt(0.975, 8)*sqrt(10*17.99981/8)*sqrt(0.1+(((68-74.5)**2)/sum((x-74.5)**2)))
80.19807-4.915294
80.19807+4.915294
# x = 75
86.8+1.015682*(75-74.5)
qt(0.975, 8)*sqrt(10*17.99981/8)*sqrt(0.1+(((75-74.5)**2)/sum((x-74.5)**2)))
87.30784-3.459006
87.30784+3.459006
# x = 82
86.8+1.015682*(82-74.5)
qt(0.975, 8)*sqrt(10*17.99981/8)*sqrt(0.1+(((82-74.5)**2)/sum((x-74.5)**2)))
94.41761-3.462993
94.41761+3.462993

# 4.7-1 (b)
# x = 68
86.8+1.015682*(68-74.5)
qt(0.975, 8)*sqrt(10*17.99981/8)*sqrt(1.1+(((68-74.5)**2)/sum((x-74.5)**2)))
80.19807-11.99192
80.19807+11.99192
# x = 75
86.8+1.015682*(75-74.5)
qt(0.975, 8)*sqrt(10*17.99981/8)*sqrt(1.1+(((75-74.5)**2)/sum((x-74.5)**2)))
87.30784-11.47531
87.30784+11.47531
# x = 82
86.8+1.015682*(82-74.5)
qt(0.975, 8)*sqrt(10*17.99981/8)*sqrt(1.1+(((82-74.5)**2)/sum((x-74.5)**2)))
94.41761-12.15924
94.41761+12.15924


